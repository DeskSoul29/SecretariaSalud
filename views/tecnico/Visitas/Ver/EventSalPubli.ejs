<!DOCTYPE html>
<html lang="es">

<head>
    <%- include('../../../tools/head'); %>
        <!-- Custom styles for this page -->
        <link href="/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" />
        </script>
        <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/amcharts/3.21.15/plugins/export/libs/FileSaver.js/FileSaver.min.js"></script>
        <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.6/xlsx.full.min.js"></script>
</head>

<body id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <%- include('../../../tools/sidebarTec'); %>
            <!-- End of Sidebar -->

            <!-- Content Wrapper -->
            <div id="content-wrapper" class="d-flex flex-column">
                <!-- Main Content -->
                <div id="content">

                    <!-- Topbar -->
                    <%- include('../../../tools/topbar'); %>
                        <!-- End of Topbar -->

                        <!-- Begin Page Content -->
                        <div class="container-fluid">

                            <!-- DataTales -->
                            <div class="card shadow mb-4">
                                <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="/tecnico/Consolidaciones/Ver">Elegir Otra
                                                Consolidación</a></li>
                                        <li class="breadcrumb-item active" aria-current="page">Eventos de Salud Publica
                                        </li>
                                    </ol>
                                </nav>
                                <button id="button-a">Create Excel</button>

                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-bordered " id="dataTable" width="100%" cellspacing="0"
                                            style="font-size: 13px;  text-align: center!important;">
                                            <thead>
                                                <tr>
                                                    <th rowspan="2">Mes</th>
                                                    <th rowspan="2">Provincia</th>
                                                    <th rowspan="2">Municipio</th>
                                                    <th colspan="2">Etas</th>
                                                    <th colspan="2">Intoxicaciones Por Sustancias Quimicas</th>
                                                    <th colspan="2">Agresiones</th>
                                                    <th colspan="2">Participación En Cove</th>
                                                    <th rowspan="2">Observaciones</th>
                                                </tr>
                                                <tr>
                                                    <th>Etas Presentadas</th>
                                                    <th>Etas Atendidas</th>

                                                    <th>Intoxicaciones Presentadas</th>
                                                    <th>Intoxicaciones Atendidas</th>

                                                    <th>Agresiones Presentadas</th>
                                                    <th>Agresiones Atendidas</th>

                                                    <th>Si/No</th>
                                                    <th>Fecha Participación</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% if (consultES){ %>
                                                    <% consultES.forEach((consultES)=> { %>
                                                        <tr>
                                                            <td>
                                                                <%= consultES.mes %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.provincia %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.municipio %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.presentEtas %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.atendEtas %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.presentIntox %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.atendIntox %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.presentAgre %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.atendAgre %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.covePart %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.coveFech %>
                                                            </td>
                                                            <td>
                                                                <%= consultES.observaciones %>
                                                            </td>
                                                        </tr>
                                                        <% }); %>
                                                            <% } %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <!-- /.container-fluid -->

                        </div>
                        <!-- End of Main Content -->

                        <!-- Footer -->
                        <%- include('../../../tools/footer'); %>
                            <!-- End of Footer -->

                </div>
                <!-- End of Content Wrapper -->

            </div>
            <!-- End of Page Wrapper -->

            <!-- Scroll to Top Button-->
            <a class="scroll-to-top rounded" href="#page-top">
                <i class="fas fa-angle-up"></i>
            </a>

            <!-- Logout Modal-->
            <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Salida</h5>
                            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
                        <div class="modal-body">Seleccione "Cerrar
                            sesión" a continuación si está listo para
                            finalizar su sesión actual.</div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancelar</button>
                            <a class="btn btn-primary" href="/tecnico/logout">Cerrar Sesión</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bootstrap core JavaScript-->
            <script src="/vendor/jquery/jquery.min.js"></script>
            <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

            <!-- Core plugin JavaScript-->
            <script src="/vendor/jquery-easing/jquery.easing.min.js"></script>

            <!-- Custom scripts for all pages-->
            <script src="/js/sb-admin-2.min.js"></script>

            <!-- Page level plugins -->
            <script src="/vendor/datatables/jquery.dataTables.min.js"></script>
            <script src="/vendor/datatables/dataTables.bootstrap4.min.js"></script>

            <!-- Page level custom scripts -->
            <script src="/js/demo/datatables-demo.js"></script>

            <script>
                $(window).bind('load', function () {
                    var nav = document.getElementById('nav2');
                    $('#navlink1').removeClass('collapsed');
                    var nav3 = document.getElementById('collapseOne');
                    var nav4 = document.getElementById('show1');
                    nav.className += "  active";
                    nav3.className += "  show";
                    nav4.className += "  active";
                });
            </script>

            <script>
                var wb = XLSX.utils.table_to_book(document.getElementById('dataTable'), { sheet: "Sheet JS" });
                var wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'binary' });

                function s2ab(s) {

                    var buf = new ArrayBuffer(s.length);
                    var view = new Uint8Array(buf);
                    for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
                    return buf;
                }
                $("#button-a").click(function () {
                    saveAs(new Blob([s2ab(wbout)], { type: "application/octet-stream" }), 'test.xlsx');
                });
            </script>

</body>

</html>